# Length-of-Stay-Prediction-for-Heart-Disease-Patients
## Introduction
This project utilizes the CMS DE-SynPUF dataset (2008–2010) to analyze healthcare patterns of heart disease patients by linking beneficiary, inpatient, outpatient, and prescription files. Focusing on a 5% sample of Medicare beneficiaries, the aim is to explore factors affecting hospital length of stay (LOS). The analysis emphasizes the impact of comorbidities, medication use, and healthcare services, using exploratory data analysis (EDA) to uncover trends and inform predictive modeling.

## Data Preparation
The data preparation process involved merging 15 samples from various Medicare files into a master dataset, filtering for patients diagnosed with heart disease using ICD-9 codes, in total of more than 10 million rows. Feature engineering included calculating age, LOS, and a new variable for prior six-month payments. Prescription data was cleaned, aggregated by year, and merged based on patient IDs. Outpatient data was selectively integrated based on physician involvement. 

## Exploratory Data Analysis (EDA)
EDA revealed that median LOS remained stable at around five days across years, with outliers indicating some prolonged stays. Most first diagnoses fell under the “Other” category, though heart disease subtypes were consistently present. Females and older adults (65–85) were more affected by chronic diseases. Drug utilization and financial burdens varied by disease type, with Heart Failure and COPD showing higher prescription and payment levels. Physician involvement also appeared to influence LOS, and cost distributions remained steady but showed disease-specific variations.
![Drug Description](https://github.com/wannidasmile/Length-of-Stay-Prediction-for-Heart-Disease-Patients/blob/main/BP_DrugPrescript.png)
![Physicians](https://github.com/wannidasmile/Length-of-Stay-Prediction-for-Heart-Disease-Patients/blob/main/BP_Physicians.png)

## Prediction Models
Linear regression performs weaker result compare to Random Forest model, capturing non-linear patterns but still showed signs of underfitting and overfitting in specific LOS ranges. Moreover, conducting Decision trees for heart disease as primary and secondary diagnoses revealed distinct key predictors. For secondary cases, race code (BENE_RACE_CD) and prior payments were dominant, indicating socioeconomic influence. In primary cases, previous payments, physician counts, and diagnosis codes drove predictions. The secondary diagnosis tree showed longer LOS (up to 18 days), while primary diagnosis cases averaged shorter stays (~6–7 days). These findings suggest different intervention strategies based on diagnosis type.

The decision tree analysis highlighted distinct patterns in predicting hospital length of stay (LOS) for patients with heart disease as a primary or secondary diagnosis. For secondary diagnosis, the most significant predictor was BENE_RACE_CD (race code), showing that patients from certain racial groups tended to stay longer—some up to 18 days. Other important variables included Previous_Payment_6M, QTY_DSPNSD_NUM, and TOT_RX_CST_AMT, suggesting that prior spending and medication intensity were closely linked to longer admissions. In contrast, for primary diagnosis, Previous_Payment_6M was the most important predictor, followed by BENE_RACE_CD, ICD9_DGNS_CD_1 (diagnosis codes), and physician-related counts like AT_PHYSN_NPI_CNT and OP_PHYSN_NPI_CNT. This indicates that for primary heart disease, clinical complexity and physician involvement played bigger roles. The trees also showed that primary diagnosis cases generally had shorter LOS (6–7 days), while secondary diagnosis cases had more variation and longer stays, pointing to the greater impact of demographic and economic factors.
![DT Heart](https://github.com/wannidasmile/Length-of-Stay-Prediction-for-Heart-Disease-Patients/blob/main/DT_heart.png)
